Вариант 15 Лабораторная работа №2. Линейные модели. Кросс-валидация.

В практических примерах ниже показано:

как пользоваться инструментами предварительного анализа для поиска линейных взаимосвязей;

как строить и интерпретировать линейные модели с логарифмами;

как оценивать точность моделей с перекрёстной проверкой (LOOCV, проверка по блокам).

Модели: множественная линейная регрессия

Зависимая переменная - Grad_Rate

Независимые переменные:

  1. Top_25_perc
  2. F_Undergrad
  3. Private

Задания:

  1. Данные своего варианта (см. таблицу ниже) разделить на выборку для построения моделей (80%) и отложенные наблюдения (20%). Оставить в таблице только указанные в варианте переменные. Отложенные наблюдения использовать только в задании 6.
  2. Провести предварительный анализ данных с помощью описательных статистик и графиков, оценить взаимосвязь.
  3. Проверить Y на нормальность. Если он распределён не по нормальному закону, прологарифмировать и снова провести анализ взаимосвязей переменных.
  4. Составить список возможных спецификаций моделей множественной регрессии (на исходной Y и на логарифме Y ).
  5. Оценить параметры моделей из списка. Оценить точность моделей методом перекрёстной проверки, указанным в варианте. Найти самую точную из моделей для Y . Найти самую точную из моделей для log(Y ).
  6. Сделать прогноз с помощью самых точных моделей на отложенные наблюдения. Рассчитать MSEtest вручную и выбрать одну наиболее точную модель. Проинтерпретировать её параметры.

Задание 1. Решение.

  Загрузим все необходимые для работы модули, определим константы и загрузим входные данные. Во входных данных отфильтруем только необходимые нам для работы признаки.

  Определим фиктивные переменные для качественного признака и объединим их с исходными данными.

  Разделим исходную выборку на тренировочную и тестовую.

Задание 2. Решение.

  Проведем предварительный анализ данных на тренировочной выборке:

    1. Построим гистограммы распределения и графики зависимости количественных переменных;
    2. Построим гистограммы распределения и графики зависимости количественных переменных для разных значений качественной переменной;
    3. Построим матрицу корреляции количественных переменных;
    4. Построим матрицу корреляции количественных переменных для разных значений качественной переменной.
    По гистограмме распределения "Grad_rate" можно сделать предположение, что данные распределены не нормально.

  По матрицам корреляции видно, что значение переменной "PrivateYes" == 1 усиливает коррелированность "Top25perc", "F_Undergrad", а значение переменной "PrivateYes" == 0 усиливает "F_Undergrad" и ослабевает "Top25perc".

Задание 3. Решение.

  Проверим распределение переменной "Grad_Rate" на нормальность при помощи теста Шапиро-Уилка. Если распределение не является нормальным, проверим логарифм переменной на нормальность.

Задание 3. Результаты.

  Мы определили, что распределение переменной "Grad_Rate" не является нормальным, поэтому будем продолжать работать с "Log_Grad_Rate"

Задание 4. Решение. Результаты.

  В соответствии с результатами задания 2 можно составить следующие линейные спецификации модели:

    1. fit_lm_1: Grad_Rate = PrivateYes + Top25perc + F_Undergrad
    2. fit_lm_2: Grad_Rate = PrivateYes + Top25perc * PrivateYes + F_Undergrad
    3. fit_lm_3: Grad_Rate = PrivateYes + F_Undergrad * PrivateYes + Top25perc
    4. fit_lm_4: Grad_Rate = PrivateYes + F_Undergrad * PrivateYes + Top25perc * PrivateYes
    5. fit_lm_1_log : то же, что fit_lm_1 , но для зависимой Log_Grad_Rate
    6. fit_lm_2_log : то же, что fit_lm_2 , но для зависимой Log_Grad_Rate
    7. fit_lm_3_log : то же, что fit_lm_3 , но для зависимой Log_Grad_Rate
    8. fit_lm_4_log : то же, что fit_lm_4 , но для зависимой Log_Grad_Rate
    9. Кроме того, добавим в сравнение модели зависимости Grad_Rate и Log_Grad_Rate от всех объясняющих переменных: fit_lm_0 и fit_lm_0_log соответственно.
    Задание 5. Решение.

  Построим модели, определенные в задании 4. Оценим точность моделей методом перекрёстной проверки. Найдём самую точную модель.

Задание 5. Результаты.

  Мы определили, что наименьшую ошибку перекрёстной проверки выдает модель fit_lm_1 и модель fit_lm_0_log.

Задание 6. Решение.

  Сделаем прогноз моделей fit_lm_1 и fit_lm_0_log на отложенных наблюдениях. Оценим точность прогноза по этим моделям на отложенные наблюдения

Задание 6. Результаты.

  Ошибка модели на отложенных наблюдениях составила 6.0% от среднего значения Y.

  В результате построения на всех данных была получена модель:

  Grad_Rate = 0.006 * Top25Perc + 0. * F_Undergrad + 0.207 * PrivateYes

Ее параметры можно интерпретировать следующим образом:

  1. При увеличении выпускного балла на 1, процент зачисленных студентов, которые в старшей школе относились к топ-25% в диапазоне по освоению увеличится на 0.006 единиц.
  2. Частный или государственный университет имеет влияние.
